<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏£</title>
    <link rel="shortcut icon" href="cool.ico" type="image/x-icon">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js'></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.2/package/dist/xlsx.full.min.js"></script>

    <link rel="stylesheet" href="style.css">
</head>
<body class="animated-gradient-bg">
    <canvas id="particle-canvas-main"></canvas>

    <div id="app-container">
        <div class="header-container">
            <h1>üêæ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡πä‡∏ô üêæ</h1>
        </div>

        <div id="calendar-wrapper">
            <div class="calendar-nav">
                <div class="nav-left-group">
                    <button class="today-btn" id="calendar-today">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</button>
                    <button class="nav-btn" id="calendar-prev">‚Äπ</button>
                    <button class="nav-btn" id="calendar-next">‚Ä∫</button>
                </div>

                <div class="nav-center-title">
                    <div class="current-month" id="calendar-title"></div>
                </div>

                <div class="view-selector">
                    <button class="view-btn" id="view-day">‡∏ß‡∏±‡∏ô</button>
                    <button class="view-btn" id="view-week">‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</button>
                    <button class="view-btn active" id="view-month">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</button>
                    <button class="view-btn" id="view-year">‡∏õ‡∏µ</button>
                </div>
            </div>
            
            <div id='calendar'></div>
            <div id="year-view-container"></div>

        </div>
        <div style="text-align: center; margin-top: 20px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; align-items: center;">
            <button id="backup-btn">‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (JSON)</button>
            <button id="export-excel-btn">‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Excel</button>
            <div id="calendar-person-filter"></div>
            <div id="show-cancelled-filter" class="person-filter-option">
                <input type="checkbox" id="show-cancelled-checkbox">
                <label for="show-cancelled-checkbox">‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ß‡∏£‡∏ó‡∏µ‡πà‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</label>
            </div>
            <div id="show-dawn-filter" class="person-filter-option">
                <input type="checkbox" id="show-dawn-checkbox" checked>
                <label for="show-dawn-checkbox">‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ß‡∏£‡∏£‡∏∏‡πà‡∏á‡∏≠‡∏£‡∏∏‡∏ì</label>
            </div>
        </div>
        
        <div id="filter-container">
            <div class="filter-grid">
                <div class="filter-group">
                    <label for="filter-person">‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£</label>
                    <select id="filter-person"></select>
                </div>
                <div class="filter-group">
                    <label for="filter-shift">‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</label>
                    <select id="filter-shift"></select>
                </div>
                <div class="filter-group">
                    <label for="filter-start-date">‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                    <input type="date" id="filter-start-date">
                </div>
                <div class="filter-group">
                    <label for="filter-end-date">‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                    <input type="date" id="filter-end-date">
                </div>
                <div class="filter-group">
                    <label for="filter-room">‡πÄ‡∏ß‡∏£</label>
                    <select id="filter-room"></select>
                </div>
                <div class="filter-group">
                     <label>&nbsp;</label>
                     <button id="clear-filters-btn">‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á</button>
                </div>
            </div>
        </div>
        
        <div id="chart-summary-container">
            <div id="chart-container">
                <canvas id="shift-chart"></canvas>
            </div>
            <div id="data-summary"></div>
        </div>

        <div id="summary-container">
            <h2>‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ß‡∏£</h2>
            <div id="summary-list">
                <p style="text-align:center; color:#888;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
            </div>
            <div id="pagination-container"></div>
        </div>

    </div>

    <footer id="page-footer">
        <p>&copy; <span id="copyright-year"></span> ‡πÅ‡∏°‡∏ß‡∏°‡∏µ‡∏°‡πÄ‡∏†‡∏™‡∏±‡∏ä ‡∏à‡∏≥‡∏Å‡∏±‡∏î | ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡πà‡∏ô 4.1.0 (Make.com + Filters)</p>
    </footer>

    <script type="module" src="script.js"></script>
</body>
</html>